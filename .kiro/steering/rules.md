---
inclusion: always
---

# 项目工作规则

## 语言与交互规范

- **始终使用中文**回答和交流
- **每次回答前**必须先说明"我对你问题的理解："，然后阐述对问题的理解，确保沟通准确
- **解释代码时**使用通俗易懂的语言，避免过度使用专业术语
- **自动执行命令**，无需等待用户确认或点击"run"按钮

## 项目环境配置

### Python 环境
- **虚拟环境路径**: `code_diff_project/venv`
- **运行 Python 脚本**时必须使用虚拟环境的 Python 解释器
- **安装新依赖**时，必须同步更新 `requirements.txt` 文件

### 测试文件管理
- **测试脚本位置**: `code_diff_project/backend/analyzer/tests/`
- **测试文件命名**: 以 `test_` 开头
- **测试完成后**: 必须删除临时测试文件
- **文档创建**: 除非明确要求，否则不创建 `.md` 文档文件

## 代码质量标准

### 设计原则
- **简洁优先**: 代码要简洁易懂，避免过度设计
- **实用至上**: 追求简单实用的解决方案
- **最小化修改**: 改动时尽量减少对其他模块的影响

### 代码规范
- **降低圈复杂度**: 函数保持小而专注
- **代码复用**: 避免重复代码，提取可复用逻辑
- **模块化设计**: 合理使用设计模式，保持模块职责清晰
- **函数粒度**: 每个函数只做一件事，保持单一职责

## Bug 修复流程

修复 Bug 时必须遵循以下步骤：

1. **理解问题**: 仔细阅读 Bug 描述和相关代码，复述对问题的理解
2. **分析原因**: 提出至少两种可能的根本原因
3. **制定计划**: 描述验证方法和修复方案
4. **执行修复**: 实施代码修复
5. **审查验证**: 检查修改是否引入新问题
6. **解释说明**: 说明做了哪些修改及原因
7. **加日志**：如果一个bug反复修改不成功，你可以自己加上日志，然后叫我重新执行把输出的日志发给你

### 代码分析要求
- 当被问及代码执行逻辑时，必须逐行理解每个函数的代码
- 基于代码实际逻辑给出准确答案，不做臆测

## MCP 交互反馈规则

- 在任何流程、任务、对话进行时，必须调用 `mcp-feedback-enhanced`
- 收到用户反馈后，必须再次调用 `mcp-feedback-enhanced` 并根据反馈调整行为
- 仅当用户明确表示「结束」或「不再需要交互」时，才停止调用
- 完成任务前，必须使用 `mcp-feedback-enhanced` 工具向用户询问反馈
